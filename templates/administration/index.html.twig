{% extends 'base.html.twig' %}

{% block title %}{{ 'administration.title'|trans }} - {{ parent() }}{% endblock %}

{% block body %}
<div class="section">
    <h2>{{ 'administration.title'|trans }}</h2>
    <h4 class="header">{{ 'administration.course_management.title'|trans }}</h4>
    {% if editable_courses|length != 0 %}
        <div class="card grey lighten-5">
            <div class="card-content">
                <span class="card-title">{{ 'administration.course_management.tu_relation.title'|trans }}</span>
                <div class="input-field row">
                    <select class="col s12 m8 l5" id="selectedCourse" name="selectedCourse">
                        {% for course in editable_courses %}
                            <option value="{{ course.id }}">{{
                                'course.form.choice_label'|trans({
                                    'courseType': course.name,
                                    'implementationYear': course.implementationDate|date('Y')
                                })
                            }}</option>
                        {% endfor %}
                    </select>
                    <label for="selectedCourse">{{ 'course.form.edit.label'|trans }}</label>
                </div>
                <div class="row">
                    <ul id="TUin" class="collection with-header col s12 l10 offset-l1 no-padding">
                        <li class="collection-header"><h5>{{ 'administration.course_management.tu_relation.linked'|trans }}</h5></li>
                    </ul>
                    <div class="col s12 center-align">
                        <button type="button" class="btn" id="add">
                            <i class="material-icons white-text">keyboard_arrow_up</i>
                        </button>
                        <button type="button" class="btn" id="remove">
                            <i class="material-icons white-text">keyboard_arrow_down</i>
                        </button>
                    </div>
                    <ul id="TUout" class="collection with-header col s12 l10 offset-l1 no-padding">
                        <li class="collection-header"><h5>{{ 'administration.course_management.tu_relation.available'|trans }}</h5></li>
                    </ul>
                </div>
            </div>
            <div class="card-action">
                <button type="submit" class="btn-flat waves-effect waves-red" id="deleteCourse">
                    {{ 'global.button.delete'|trans }}
                </button>
            </div>
        </div>
    {% endif %}{# if courses aren't empty #}
    <div class="card grey lighten-5">
        {{ form_start(new_course) }}
            <div class="card-content">
                <span class="card-title">{{ 'course.form.new.title'|trans }}</span>
                <div class="row">
                    {{ form_row(new_course.implementationDate, { 'attr': {'class': 'col s12 m6'} }) }}
                    {{ form_row(new_course.semester, { 'attr': {'class': 'input-field col s12 m6'} }) }}
                </div>
            </div>
            <div class="card-action">
                <button type="submit" class="btn-flat waves-effect waves-light">
                    {{ 'global.button.create'|trans }}
                </button>
            </div>
        {{ form_end(new_course) }}
    </div>
</div>
<div class="section">
    <h4 class="header">{{ 'administration.semester_management.title'|trans }}</h4>
    <div class="card grey lighten-5">
        <div class="card-content">
            <span class="card-title">{{ 'administration.semester_management.list'|trans }}</span>
            <table id='tableSemestre'>
                <thead>
                    <tr>
                        <th>{{ 'semester.props.start_date'|trans }}</th>
                        <th>{{ 'semester.props.end_date'|trans }}</th>
                        <th>{{ 'semester.props.type'|trans }}</th>
                        <th>{{ 'semester.props.groups'|trans }}</th>
                        <th>{{ 'semester.props.manage'|trans }}</th>
                    </tr>
                </thead>
                <tbody>
                    {% for semester in semesters %}
                        <tr>
                            <td>{{ semester.startDate|date('global.date.format'|trans) }}</td>
                            <td>{{ semester.endDate|date('global.date.format'|trans) }}</td>
                            <td>{{ semester.course.name }}</td>
                            <td>
                                {% for group in semester.groups %}
                                    {% if not loop.first %} - {% endif %}
                                    {{ group.name }}
                                {% endfor %}
                            </td>
                            <td>
                                <a href="{{ path('administration_semester', { 'id': semester.id }) }}">
                                    <i class="material-icons">
                                        {% if semester.endDate < date() %}
                                            edit
                                        {% else %}
                                            add_to_queue
                                        {% endif %}
                                    </i>
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    <div class="card grey lighten-5">
        {{ form_start(new_semester) }}
            <div class="card-content">
                <span class="card-title">{{ 'administration.creation.title'|trans }}</span>
                <div class="row">
                    {{ form_row(new_semester.course, { 'attr': {'class': 'col s12 m6 l5'} }) }}
                    <div class="col s12 m6 l5 offset-l1">
                        {{ form_row(new_semester.startDate) }}
                        {{ form_row(new_semester.endDate) }}
                    </div>
                </div>
            </div>
            <div class="card-action">
                <button type="submit" class="btn-flat waves-effect waves-light">
                    {{ 'global.button.create'|trans }}
                </button>
            </div>
        {{ form_end(new_semester) }}
    </div>
</div>
{% endblock body %}

{% block scripts %}
    {{ parent() }}
    <script src="{{ asset('build/administration.js') }}"></script>
{% endblock %}
